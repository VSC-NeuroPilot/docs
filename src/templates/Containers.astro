---
import {
  Tabs,
  TabItem,
  Code,
  FileTree,
  Steps,
  LinkButton,
} from "@astrojs/starlight/components";
import { BASE_GITHUB_ORG } from "@consts/links";
import { SHOWCASE_IGNORES } from "@consts/showcases";
import { ShowcaseProfile } from "starlight-showcases";
import { ContributorList } from "starlight-contributor-list";

interface Props {
  repoName: string;
  containerName: string;
  description: string;
  dockerfileCode: string;
  devcontainerCode: string;
  dockerPullCode: string;
  fileTreeContent: any;
  includedSoftware: any;
}

const {
  repoName,
  containerName,
  description,
  dockerfileCode,
  devcontainerCode,
  dockerPullCode,
  fileTreeContent,
  includedSoftware,
} = Astro.props;

const profiles = [
  {
    name: "GitHub Packages listing",
    picture: import("@assets/icons/docker-mark-blue.svg"),
    href: `${BASE_GITHUB_ORG}${repoName}/pkgs/container/${repoName}`,
    description: "Public listing on VSC-NeuroPilot's GitHub Packages.",
  },
  {
    name: "Source code repository",
    picture: import("@assets/icons/github-mark.svg"),
    href: `${BASE_GITHUB_ORG}/${repoName}`,
    description:
      "The source repository where the container is built and pushed to ghcr.io.",
  },
];
---

<p>{description}</p>

<ShowcaseProfile entries={profiles} />

<h2>Contributors</h2>

<ContributorList
  githubRepo={`VSC-NeuroPilot/${repoName}`}
  ignore={SHOWCASE_IGNORES}
/>

<h2>Use the image</h2>

<Tabs syncKey="containerImageObtainMethod">
  <TabItem label="Docker">
    <Code name="Dockerfile" lang="docker" code={dockerfileCode} />
  </TabItem>
  <TabItem label=".devcontainer/devcontainer.json">
    <Code
      name=".devcontainer/devcontainer.json"
      lang="json"
      code={devcontainerCode}
    />
  </TabItem>
  <TabItem label="Docker pull">
    <Code name="docker pull" lang="sh" code={dockerPullCode} />
  </TabItem>
  <TabItem label="GitHub Codespaces">
    <p>
      <LinkButton
        href={`https://github.com/new?template_name=${repoName}&template_owner=VSC-NeuroPilot`}
        >Create repo from template</LinkButton
      >
    </p>
    <Steps>
      <ol>
        <li>
          Click the button above to create a new repository from the template.
        </li>
        <li>Press <code>.</code> to open the GitHub Codespaces web app.</li>
        <li>Start coding!</li>
      </ol>
    </Steps>
  </TabItem>
  <TabItem label="Local dev containers">
    <p>This requires Docker Desktop to be installed.</p>
    <p>
      <LinkButton
        href="https://marketplace.visualstudio.com/item?itemName=ms-vscode-remote.remote-containers"
        >Dev Containers listing on VS Marketplace</LinkButton
      >
    </p>
    <Steps>
      <ol>
        <li>
          Install the Dev Containers VS Code extension using the link above.
        </li>
        <li>Open the folder. If it's already open, reload the window.</li>
        <li>Click on the prompt to reload in a dev container.</li>
        <li>The container should be set up automatically.</li>
      </ol>
    </Steps>
  </TabItem>
</Tabs>

<h2>File tree</h2>

<p>Relative to <code>/workspace</code>:</p>

<FileTree>
  <slot name="fileTree" />
</FileTree>

<h2>Included software</h2>

<slot name="includedSoftware" />
